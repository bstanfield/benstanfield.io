//- INCLUDES > MIXINS
mixin project(color, title, description, img)
    .project-card.top(style="background-color:" + color + ";")
        .project-content
            h1 #{title}
            p #{description}
            button View more
            img(src="images/" + img)

mixin link(url, name, tooltip)
    a(target='_blank' class='orange-link' href=url title=tooltip)= name

mixin imgLink(item)
    if item.img
        li    
            a.img-link(title=item.img) #{item.name} âœ¨
    else
        li
            a.img-link #{item.name}

mixin more()
    p.more Learn more <span>&rarr;</span>

mixin 3card(url, emoji, title, description, target)
    a(target=target href=url).thirds-col.card
        h2 <span class='emo'>#{emoji}</span> #{title}
        p #{description}
        +more()

mixin contact()
    h1 Contact
    p
        | If you'd like to work with me or learn more, please send me an email through the form below or find me on 
        +link('https://www.linkedin.com/in/meetben', 'LinkedIn', '"Join my professional network ðŸ¤“"')
        | . Thanks for stopping by!

    br
    form(accept-charset="UTF-8" action="https://formkeep.com/f/caa230f30e8d" method="POST")
        .label-input-group
            label(for='fname') NAME
            input(type='text' id='fname' name='firstname' placeholder='Adam Grant')
        .label-input-group
            label(for='lname') EMAIL *
            input(type='email' id='email' name='email' placeholder='adamgrant@email.com' required)

        .label-input-group
            label(for='subject') MESSAGE *
            <textarea id="subject" name="subject" placeholder="Hey Ben! Adam here. Just checked out your website and I have some... feedback." style="height:200px" required></textarea>

        input(type='submit' value='Submit')

//- PROJECT PAGE
mixin introsection(title, subtitle, date, emoji)
    if emoji
        h1.big-emoji #{emoji}
    h1= title
    p= subtitle
    p.update-line #{date}
    br

mixin quote(quote, byline)
    .quote
        h2 #{quote}
        p #{byline}

mixin widequote(quote, byline)
    .quote(style='width: 80%; display: block; max-width: 600px; margin-right: 30px;')
        h2 #{quote}
        p #{byline}

mixin article(url, iconpath, title, subtitle, sourcename, bgimage)
    <div style="clear: both;"></div>
    a(target='_blank' href=url).card.project-card
        img(src=iconpath)
        h2 #{title}
        p #{subtitle}
        
        p.more Read on #{sourcename} <span>&rarr;</span>
        .project-img(style=bgimage)

mixin reviewGallery(meta, hours, distance, arr)
    - const shopUrl = 'https://www.yelp.com/biz/' + meta.yelpUrl;
    - const heroImg = '../../images/projects/coffee/' + meta.heroImg;
    - const urlBase = 'https://s3-media3.fl.yelpcdn.com/bphoto/';
    - const date = new Date;

    .review
        a(target='_blank' href=shopUrl)
            h4 #{meta.shopName}
        </a>
        if hours
            each obj in hours
                if (date.toString().slice(0,3) == obj.day)
                    if date.getHours() > obj.open && date.getHours() < obj.close
                        p <span class='meta-emoji'>&nbsp;âœ…&nbsp;</span> They're <strong style='color: green;'>open</strong> right now! (#{obj.day}. #{obj.open} AM - #{((obj.close + 11) % 12 + 1)} PM)
                        p <span class='meta-emoji'>&nbsp;ðŸš™ &nbsp;</span> It's typically a <strong>#{distance} minute</strong> drive from campus at 10 AM.
                    else
                        p &nbsp; ðŸŒƒ  &nbsp; They're <strong>closed</strong> for the rest of #{date.toLocaleDateString(locale, { weekday: 'long' })}.
                        p &nbsp; ðŸš™  &nbsp; It's typically a <strong>#{distance} minute</strong> drive from campus at 10 AM.
        br
        .gallery-blackbox
            .fill
                a(data-fancybox=meta.shopName href=heroImg)
                    img(src=heroImg)
            .gallery-indicator
                a(data-fancybox=meta.shopName href=heroImg) <i class="far fa-image"></i> View gallery

            .gallery-container.flex-grid
                each url in arr
                    +galleryPhoto(meta.shopName, urlBase+url+'/o.jpg')

mixin galleryPhoto(shopName, yelpImg)
    .gallery-photo
        a(data-fancybox=shopName href=yelpImg)
            img(src=yelpImg)

mixin scorecard(goodObj, badObj)
    .scorecard
        .flex-grid
            .score-col
                h2 Best for:
                each pair in Object.entries(goodObj)
                    div
                        .score-emoji
                            span(class=pair[0].slice(0,3))
                        .score-text
                            p <strong>#{pair[0]}:</strong> #{pair[1]}
                hr 
            .score-col
                h2 Not great for:
                each pair in Object.entries(badObj)
                    div
                        .score-emoji
                            span(class=pair[0].slice(0,3))
                        .score-text
                            p <strong>#{pair[0]}:</strong> #{pair[1]}

mixin recs(itemObjs)
    .recs
        h2 Coffee and food recommendations:
        ol
            each item in itemObjs
                +imgLink(item)
        br
        br

mixin reviewNotes(meta, notes, guestNotes, recs)
    - const shopUrl = 'https://www.yelp.com/biz/' + meta.yelpUrl;
    .writeup
        h4 Notes on #{meta.shopName}:
        each par in notes
            h6= par
        if guestNotes
            .writeup-guest
                img(style='background-image: url(' + guestNotes.img + ')')
                h6 <strong>From #{guestNotes.name}</strong> #{guestNotes.notes}
        +recs(recs)
    .proj-button-container
        a(href=shopUrl class='proj-button' target='_blank') <i class="fab fa-yelp"></i>&nbsp; View #{meta.shopName} on Yelp 
        hr
        br
        br

mixin review(shops)        
    each shop in shops
        .review
            +reviewGallery(shop[0].meta, shop[0].hours, shop[0].distance, shop[0].images)
            +scorecard(shop[0].good, shop[0].bad)
            +reviewNotes(shop[0].meta, shop[0].notes, shop[0].guestNotes, shop[0].recs)
